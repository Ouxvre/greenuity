<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Informasi Perangkat - Greenuity</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { poppins: ['Poppins', 'sans-serif'] },
            colors: { primary: "#1B4D57" }
          }
        }
      };
    </script>
</head>
<body class="bg-gray-50 min-h-screen font-poppins pb-8">
    <!-- Header -->
    <div class="bg-white px-6 py-4 sticky top-0 z-10 shadow-sm">
      <div class="flex items-center justify-between">
        <button onclick="goBack()" class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
        <h1 class="text-lg font-bold">Informasi Perangkat</h1>
        <div class="w-10"></div>
      </div>
    </div>

    <!-- Content -->
    <div class="px-6 py-6 max-w-md mx-auto space-y-6">
      
      <!-- Device ID Info -->
      <div class="bg-gradient-to-r from-primary to-primary/80 text-white rounded-2xl p-5 shadow-lg">
        <div class="flex items-center space-x-3 mb-2">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"/>
          </svg>
          <div>
            <p class="text-xs opacity-80">Device ID</p>
            <p class="text-lg font-bold font-mono" id="displayDeviceId">-</p>
          </div>
        </div>
      </div>

      <!-- Form Container -->
      <div class="bg-white rounded-2xl p-6 shadow-lg space-y-5">
        <h3 class="text-lg font-bold text-gray-800">ğŸ“‹ Data Lahan</h3>

        <!-- Nama Lahan -->
        <div>
          <label class="block text-sm font-semibold text-gray-800 mb-2">Nama Lahan *</label>
          <input type="text" id="fieldName" 
                 class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition"
                 placeholder="Lahan Cabai Belakang Rumah"
                 required>
        </div>

        <!-- Jenis Tanaman -->
        <div>
          <label class="block text-sm font-semibold text-gray-800 mb-2">Jenis Tanaman *</label>
          <select id="plantType" 
                  class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition">
            <option value="">Pilih jenis tanaman</option>
            <option value="cabai">ğŸŒ¶ï¸ Cabai</option>
            <option value="tomat">ğŸ… Tomat</option>
            <option value="terong">ğŸ† Terong</option>
            <option value="sawi">ğŸ¥¬ Sawi</option>
            <option value="kangkung">ğŸ¥¬ Kangkung</option>
            <option value="bayam">ğŸ¥¬ Bayam</option>
            <option value="selada">ğŸ¥— Selada</option>
            <option value="timun">ğŸ¥’ Timun</option>
            <option value="jagung">ğŸŒ½ Jagung</option>
            <option value="padi">ğŸŒ¾ Padi</option>
            <option value="lainnya">ğŸŒ± Lainnya</option>
          </select>
        </div>

        <!-- Luas Lahan -->
        <div>
          <label class="block text-sm font-semibold text-gray-800 mb-2">Luas Lahan (mÂ²)</label>
          <input type="number" id="fieldArea" 
                 class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition"
                 placeholder="100"
                 min="1"
                 step="0.1">
        </div>

        <!-- Lokasi -->
        <div>
          <label class="block text-sm font-semibold text-gray-800 mb-2">Lokasi (Opsional)</label>
          <input type="text" id="location" 
                 class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition"
                 placeholder="Bekasi, Jawa Barat">
        </div>
      </div>

      <!-- Threshold Settings -->
      <div class="bg-white rounded-2xl p-6 shadow-lg space-y-5">
        <h3 class="text-lg font-bold text-gray-800">âš™ï¸ Pengaturan Irigasi Otomatis</h3>
        
        <div class="bg-blue-50 rounded-xl p-4">
          <p class="text-xs text-blue-800">
            ğŸ’¡ <strong>Tips:</strong> Pompa akan menyala otomatis jika kelembapan tanah di bawah nilai minimal, dan mati jika sudah mencapai nilai maksimal.
          </p>
        </div>

        <!-- Threshold Min -->
        <div>
          <label class="block text-sm font-semibold text-gray-800 mb-2">Kelembapan Minimal (%) *</label>
          <input type="number" id="thresholdMin" 
                 class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition text-lg font-bold text-center"
                 placeholder="35"
                 min="0"
                 max="100"
                 value="35"
                 required>
          <p class="text-xs text-gray-500 mt-1">Pompa menyala jika kelembapan &lt; nilai ini</p>
        </div>

        <!-- Threshold Max -->
        <div>
          <label class="block text-sm font-semibold text-gray-800 mb-2">Kelembapan Maksimal (%) *</label>
          <input type="number" id="thresholdMax" 
                 class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition text-lg font-bold text-center"
                 placeholder="75"
                 min="0"
                 max="100"
                 value="75"
                 required>
          <p class="text-xs text-gray-500 mt-1">Pompa mati jika kelembapan &gt; nilai ini</p>
        </div>
      </div>

      <!-- WiFi Configuration -->
      <div class="bg-white rounded-2xl p-6 shadow-lg space-y-5">
        <div class="flex items-center space-x-2">
          <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"/>
          </svg>
          <h3 class="text-lg font-bold text-gray-800">ğŸ” Konfigurasi WiFi</h3>
        </div>
        
        <div class="bg-yellow-50 rounded-xl p-4">
          <p class="text-xs text-yellow-800">
            âš ï¸ <strong>Penting:</strong> Perangkat akan terhubung ke WiFi ini untuk mengirim data sensor ke cloud.
          </p>
        </div>

        <!-- WiFi SSID -->
        <div>
          <label class="block text-sm font-semibold text-gray-800 mb-2">Nama WiFi (SSID) *</label>
          <input type="text" id="wifiSSID" 
                 class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition"
                 placeholder="WiFi_Rumah"
                 required>
        </div>

        <!-- WiFi Password -->
        <div>
          <label class="block text-sm font-semibold text-gray-800 mb-2">Password WiFi *</label>
          <div class="relative">
            <input type="password" id="wifiPassword" 
                   class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition pr-12"
                   placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                   required>
            <button type="button" onclick="toggleWiFiPassword()" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600">
              <svg id="wifiEyeIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
              </svg>
            </button>
          </div>
          <p class="text-xs text-gray-500 mt-1">ğŸ”’ Password akan dienkripsi untuk keamanan</p>
        </div>
      </div>

      <!-- Submit Button -->
      <button onclick="saveDevice()" class="w-full py-4 bg-gradient-to-r from-primary to-primary/80 text-white rounded-xl font-bold text-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]">
        Simpan
      </button>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black/60 hidden items-center justify-center z-50">
      <div class="bg-white rounded-3xl p-8 text-center max-w-sm mx-4 shadow-2xl">
        <div class="animate-spin rounded-full h-16 w-16 border-4 border-primary border-t-transparent mx-auto mb-4"></div>
        <p class="text-gray-800 font-bold text-lg mb-2">Menyimpan Perangkat...</p>
        <p class="text-gray-500 text-sm">Mohon tunggu sebentar</p>
      </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black/60 hidden items-center justify-center z-50 px-6">
      <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center animate-bounce-in">
        <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse">
          <svg class="w-12 h-12 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
          </svg>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-3">ğŸ‰ Berhasil!</h3>
        <p class="text-gray-600 mb-6">
          Perangkat SmartFarm Anda telah terhubung dan siap digunakan untuk monitoring lahan.
        </p>
        <button onclick="goToDashboard()" class="w-full py-3 px-6 rounded-xl bg-primary text-white font-semibold hover:bg-primary/90 transition mb-3">
          Lihat Dashboard
        </button>
        <button onclick="addAnotherDevice()" class="w-full py-3 px-6 rounded-xl border-2 border-primary text-primary font-semibold hover:bg-primary/5 transition">
          + Tambah Perangkat Lain
        </button>
      </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="/js/config/firebase-config.js"></script>


    <!-- Device Info Script -->
    <script src="/js/monitoring/device-info.js"></script>
</body>
</html>